import { Box, Chip, Divider, Grid, Link, Typography, } from '@mui/material';
import { useFormatter } from '../../../../../components/i18n';

const GeneralVulnerabilityInfoTab = () => {
  const { fldt, t } = useFormatter();

  return (
    <Box p={3}>
      {/* CVE Title */}
      <Typography variant="h5" gutterBottom>
        {cveId}
      </Typography>

      {/* Description */}
      <Typography variant="subtitle1" fontWeight="bold" gutterBottom>
        Description
      </Typography>
      <Typography variant="body2" paragraph>
        {description || 'No description available.'}
      </Typography>

      <Divider sx={{ my: 2 }} />

      {/* Quick Info */}
      <Typography variant="subtitle1" fontWeight="bold" gutterBottom>
        Quick Info
      </Typography>
      <Grid container spacing={2}>
        <Grid item xs={12} md={6}>
          <Typography variant="body2">
            <strong>Published:</strong> {publishedDate ? fldt(publishedDate) : 'N/A'}
          </Typography>
        </Grid>
        <Grid item xs={12} md={6}>
          <Typography variant="body2">
            <strong>Source:</strong> {source || 'N/A'}
          </Typography>
        </Grid>
        <Grid item xs={12} md={6}>
          <Typography variant="body2">
            <strong>Severity:</strong>{' '}
            {severity ? <Chip label={severity.toUpperCase()} color="warning" /> : 'N/A'}
          </Typography>
        </Grid>
      </Grid>

      <Divider sx={{ my: 2 }} />

      {/* CWE Info */}
      <Typography variant="subtitle1" fontWeight="bold" gutterBottom>
        CWE
      </Typography>
      {cwe ? (
        <Typography variant="body2">{cwe}</Typography>
      ) : (
        <Typography variant="body2">No CWE assigned.</Typography>
      )}

      <Divider sx={{ my: 2 }} />

      {/* References */}
      <Typography variant="subtitle1" fontWeight="bold" gutterBottom>
        References
      </Typography>
      {references && references.length > 0 ? (
        references.map((ref: string, idx: number) => (
          <Typography variant="body2" key={idx}>
            <Link href={ref} target="_blank" rel="noopener noreferrer">
              {ref}
            </Link>
          </Typography>
        ))
      ) : (
        <Typography variant="body2">No references available.</Typography>
      )}
    </Box>
  );
};

export default GeneralVulnerabilityInfoTab;
